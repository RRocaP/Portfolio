---
import { seoManager, type SEOConfig } from '../utils/seoManager';
import PerformanceMonitor from '../components/PerformanceMonitor.astro';
import CoreWebVitalsOptimizer from '../components/CoreWebVitalsOptimizer.astro';
import ScrollAnimations from '../components/ScrollAnimations.astro';

export interface Props {
  title: string;
  description?: string;
  lang?: 'en' | 'es' | 'ca';
  type?: 'website' | 'article' | 'profile';
  image?: string;
  imageAlt?: string;
  keywords?: string[];
  author?: string;
  publishedTime?: string;
  modifiedTime?: string;
  section?: string;
  tags?: string[];
  noindex?: boolean;
  nofollow?: boolean;
  priority?: number;
  changefreq?: 'always' | 'hourly' | 'daily' | 'weekly' | 'monthly' | 'yearly' | 'never';
  breadcrumbs?: Array<{ name: string; url: string }>;
  customSchema?: Record<string, any>;
  pathname?: string;
  /** Optional theme switch (default is navy across pages) */
  theme?: 'navy' | 'navy-gold' | 'ml-native';
}

const { 
  title, 
  description = 'Biomedical engineer and molecular biologist developing next-generation antimicrobial therapies through AI-driven protein engineering', 
  lang = 'en',
  type = 'website',
  image,
  imageAlt,
  keywords,
  author,
  publishedTime,
  modifiedTime,
  section,
  tags,
  noindex = false,
  nofollow = false,
  priority,
  changefreq,
  breadcrumbs,
  customSchema,
  pathname,
  theme = 'navy'
} = Astro.props;

// Use provided pathname or fall back to Astro.url.pathname for backwards compatibility
const currentPathname = pathname || (typeof Astro !== 'undefined' && Astro.url ? Astro.url.pathname : '/');

// Normalize BASE_URL to always end with / for path concatenation
const base = import.meta.env.BASE_URL.endsWith('/') ? import.meta.env.BASE_URL : import.meta.env.BASE_URL + '/';

const seoConfig: SEOConfig = {
  title,
  description,
  lang,
  canonical: seoManager.generateCanonicalUrl(currentPathname, lang),
  type,
  image,
  imageAlt,
  keywords,
  author,
  publishedTime,
  modifiedTime,
  section,
  tags,
  noindex,
  nofollow,
  priority,
  changefreq,
  breadcrumbs,
  schema: customSchema
};

const hreflangLinks = seoManager.generateHreflangLinks(currentPathname);
const seoHeadContent = seoManager.generateSEOHead(seoConfig);
---

<!DOCTYPE html>
<html lang={lang} data-theme={theme || undefined}>
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <meta name="generator" content={Astro.generator} />
    
    <!-- SEO Meta Tags -->
    <Fragment set:html={seoManager.generateMetaTags(seoConfig)} />
    
    <!-- Hreflang Links -->
    {hreflangLinks.map(link => (
      <link rel="alternate" href={link.href} hreflang={link.hreflang} />
    ))}
    
    <!-- Structured Data -->
    <Fragment set:html={seoManager.generatePersonSchema()} />
    <Fragment set:html={seoManager.generateWebsiteSchema(seoConfig)} />
    
    {breadcrumbs && (
      <Fragment set:html={seoManager.generateBreadcrumbSchema(breadcrumbs)} />
    )}
    
    {customSchema && (
      <script type="application/ld+json" set:html={JSON.stringify(customSchema, null, 2)}></script>
    )}
    
    <!-- Open Graph Tags -->
    <Fragment set:html={seoManager.generateOpenGraphTags(seoConfig)} />
    
    <!-- Twitter Card Tags -->
    <Fragment set:html={seoManager.generateTwitterTags(seoConfig)} />
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Outfit:wght@400;500;600;700;800&display=swap">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Outfit:wght@400;500;600;700;800&display=swap" rel="stylesheet" media="print" onload="this.media='all'">
    <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;700&display=swap">
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;700&display=swap" rel="stylesheet" media="print" onload="this.media='all'">
    
    <!-- Inline Critical CSS - Above-the-fold performance -->
    <style>
      /* Critical Typography & Design System - Multilingual Optimized */
      :root{
        /* Color System */
        --catalan-red:#DA291C;--catalan-yellow:#FFD93D;--primary:#F5F5F5;--secondary:#D4D4D4;--tertiary:#B8B8B8;--accent-red:#EF4444;--accent-red-hover:#FF5555;--accent-red-bg:rgba(220,38,38,0.10);--accent-yellow:#FFD93D;--background:#0A0A0A;--background-alt:#171717;--background-card:#1E1E1E;--background-elevated:#252525;--background-rgb:10,10,10;--accent-red-rgb:220,38,38;--border:#333333;--border-light:#404040;--border-red:rgba(218,41,28,0.3);
        
        /* Typography System - Unified Font Stack */
        --font-primary:'Inter',-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Oxygen,Ubuntu,Cantarell,sans-serif;
        --font-display:'Outfit','Inter',-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;
        --font-mono:'SF Mono',Monaco,'Cascadia Code','Roboto Mono',Consolas,'Courier New',monospace;
        
        /* Typography Scale - Major Third (1.25) + Fluid Sizing */
        --text-xs:0.75rem;--text-sm:0.875rem;--text-base:1rem;--text-lg:1.125rem;--text-xl:1.25rem;--text-2xl:1.5rem;--text-3xl:1.875rem;--text-4xl:2.25rem;--text-5xl:3rem;--text-6xl:4rem;
        
        /* Font Weights - Optimized for multilingual */
        --font-light:300;--font-normal:400;--font-medium:500;--font-semibold:600;--font-bold:700;--font-extrabold:800;
        
        /* Line Heights - Language Aware */
        --leading-none:1;--leading-tight:1.25;--leading-snug:1.375;--leading-normal:1.5;--leading-relaxed:1.625;--leading-loose:1.75;
        
        /* Letter Spacing - Typography Optimized */
        --tracking-tighter:-0.05em;--tracking-tight:-0.025em;--tracking-normal:0em;--tracking-wide:0.025em;--tracking-wider:0.05em;
        
        /* Spacing & Layout */
        --space-xs:0.5rem;--space-sm:1rem;--space-md:2rem;--space-lg:4rem;--space-xl:8rem;
        
        /* Animation */
        --anim-duration-fast:200ms;--anim-duration-base:300ms;--anim-duration-slow:500ms;--anim-easing-default:cubic-bezier(0.4,0,0.2,1);
        
        /* Glass Effect */
        --glass-bg:rgba(255,255,255,0.05);--glass-border:rgba(255,255,255,0.1);--glass-blur:16px;
        
        /* Z-Index */
        --z-base:0;--z-dropdown:100;--z-sticky:200;--z-modal:300;--z-toast:400;
      }
      
      /* Reset & Base */
      *{margin:0;padding:0;box-sizing:border-box}
      html{scroll-behavior:smooth;font-size:16px}
      
      /* Body Typography - Multilingual Optimized */
      body{
        font-family:var(--font-primary);
        font-weight:var(--font-normal);
        line-height:var(--leading-normal);
        color:var(--primary);
        background-color:var(--background);
        font-size:clamp(1rem,1.25vw,1.125rem);
        letter-spacing:var(--tracking-normal);
        -webkit-font-smoothing:antialiased;
        -moz-osx-font-smoothing:grayscale;
        text-rendering:optimizeLegibility;
      }
      
      /* Language-specific typography adjustments - Enhanced */
      body:lang(es),body:lang(ca){
        line-height:var(--leading-relaxed);
        word-spacing:0.02em;
        /* Improved text wrapping for multilingual content */
        overflow-wrap:break-word;
        word-wrap:break-word;
        hyphens:auto;
      }
      
      /* Standardized Heading Typography */
      h1,h2,h3,h4,h5,h6{
        font-family:var(--font-display);
        font-weight:var(--font-bold);
        line-height:var(--leading-tight);
        margin-bottom:1rem;
        letter-spacing:var(--tracking-tight);
        color:var(--primary);
      }
      
      /* Responsive heading scale */
      h1{font-size:clamp(2.25rem,6vw,4rem);font-weight:var(--font-extrabold)}
      h2{font-size:clamp(1.875rem,5vw,3rem);font-weight:var(--font-bold)}
      h3{font-size:clamp(1.5rem,4vw,2.25rem);font-weight:var(--font-semibold)}
      h4{font-size:clamp(1.25rem,3vw,1.875rem);font-weight:var(--font-semibold)}
      h5{font-size:clamp(1.125rem,2.5vw,1.25rem);font-weight:var(--font-medium)}
      h6{font-size:1rem;font-weight:var(--font-medium)}
      
      /* Language-specific heading optimizations - Design system aligned */
      h1:lang(es),h1:lang(ca){font-size:clamp(2rem,5.5vw,3.75rem);line-height:1.2;overflow-wrap:break-word;hyphens:auto}
      h2:lang(es),h2:lang(ca){font-size:clamp(1.75rem,4.5vw,2.75rem);line-height:1.2;overflow-wrap:break-word;hyphens:auto}
      h3:lang(es),h3:lang(ca){line-height:1.3;overflow-wrap:break-word;hyphens:auto}
      
      /* Ensure all headings can wrap properly */
      h1,h2,h3,h4,h5,h6{overflow-wrap:break-word;word-wrap:break-word;hyphens:auto;max-width:100%}
      
      /* Critical Components */
      .glass{background:var(--glass-bg);backdrop-filter:blur(var(--glass-blur));border:1px solid var(--glass-border)}
      .gpu-accelerated{transform:translateZ(0);backface-visibility:hidden;perspective:1000px}
      .will-change-transform{will-change:transform}
      .will-change-opacity{will-change:opacity}
      .will-change-auto{will-change:auto}
      
      /* Layout - Overflow protection */
      .container{max-width:min(1280px,100vw);margin:0 auto;padding:0 1.5rem;box-sizing:border-box;overflow-wrap:break-word}
      .section{padding:var(--space-xl) 0;position:relative}
      
      /* Navigation */
      .nav-premium{
        position:fixed;top:0;left:0;right:0;z-index:var(--z-sticky);
        background:radial-gradient(120% 100% at 50% -20%,rgba(15,15,15,0.75) 0%,rgba(10,10,10,0.7) 100%);
        backdrop-filter:blur(16px);border-bottom:1px solid rgba(255,255,255,0.05);
        transition:transform var(--anim-duration-base) var(--anim-easing-default);
        will-change:transform;
      }
      
      /* Hero */
      .hero-final{position:relative;min-height:100vh;display:flex;align-items:center;justify-content:center;background:var(--background);overflow:hidden}
      
      /* Buttons */
      .btn{
        padding:0.875rem 2rem;min-height:44px;font-size:1rem;font-weight:600;
        text-decoration:none;border-radius:8px;
        transition:all var(--anim-duration-base) var(--anim-easing-default);
        display:inline-flex;align-items:center;gap:0.75rem;
        position:relative;overflow:hidden;outline:none;cursor:pointer;border:none;
      }
      .btn:focus-visible{box-shadow:0 0 0 3px rgba(239,68,68,.45),0 0 0 5px rgba(255,255,255,.15)}
      .btn-primary{background:var(--accent-red);color:#FFFFFF;border:1px solid var(--accent-red);box-shadow:0 8px 30px rgba(220,38,38,0.25)}
      .btn-primary:hover{background:var(--accent-red-hover);box-shadow:0 10px 40px rgba(220,38,38,0.3);transform:translateY(-2px)}
      
      /* Responsive - Enhanced mobile support */
      @media(max-width:768px){
        .section{padding:var(--space-lg) 0}
        .container{padding:0 1rem;max-width:100vw}
        .btn{min-height:48px;min-width:48px}
        
        /* Mobile text wrapping */
        h1,h2,h3,h4,h5,h6{word-break:break-word;overflow-wrap:break-word;hyphens:auto}
      }
      
      /* Extra small screens */
      @media(max-width:480px){
        .container{padding:0 0.75rem}
        
        /* Most conservative text handling for small screens */
        h1:lang(es),h1:lang(ca){font-size:clamp(1.75rem,8vw,2.5rem)}
        h2:lang(es),h2:lang(ca){font-size:clamp(1.5rem,7vw,2rem)}
        h3:lang(es),h3:lang(ca){font-size:clamp(1.25rem,6vw,1.5rem)}
      }
      
      /* Accessibility */
      @media(prefers-reduced-motion:reduce){
        *{animation-duration:0.01ms!important;animation-iteration-count:1!important;transition-duration:0.01ms!important}
        html{scroll-behavior:auto}
      }
    </style>
    
    <!-- Optimized CSS Loading Strategy -->
    <!-- Core styles (essential) -->
    <link rel="preload" as="style" href={`${base}styles/optimized-core.css`} onload="this.onload=null;this.rel='stylesheet'">

    <!-- Enhanced styles (progressive enhancement) -->
    <link rel="preload" as="style" href={`${base}styles/optimized-enhanced.css`} onload="this.onload=null;this.rel='stylesheet'" media="screen">

    <!-- Design tokens -->
    <link rel="preload" as="style" href={`${base}styles/tokens.css`} onload="this.onload=null;this.rel='stylesheet'">

    <!-- Accessibility styles -->
    <link rel="preload" as="style" href={`${base}styles/optimized-accessibility.css`} onload="this.onload=null;this.rel='stylesheet'">

    <noscript>
      <link rel="stylesheet" href={`${base}styles/optimized-core.css`}>
      <link rel="stylesheet" href={`${base}styles/optimized-enhanced.css`}>
      <link rel="stylesheet" href={`${base}styles/optimized-accessibility.css`}>
    </noscript>
    <noscript>
      <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Outfit:wght@400;500;600;700;800&display=swap" rel="stylesheet">
      <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;700&display=swap" rel="stylesheet">
    </noscript>
    
    <!-- Theme overrides (navy + navy-gold) -->
    <style>
      [data-theme='navy']{
        --accent-red:#1e40af; --accent-red-hover:#2563eb; --accent-red-bg:rgba(30,64,175,0.12);
        --accent-yellow:#60a5fa; --accent-red-rgb:30,64,175;
        --background:#070a12; --background-alt:#0d1320; --background-card:#11182a; --background-elevated:#131c2e;
        --border:#1f2a44; --border-light:#2a3a5f; --text-primary:#f3f6ff; --text-secondary:#d6def7; --text-light:#a8b4d9; --text-muted:#8a97bf;
      }
      [data-theme='navy-gold']{
        --background:#070a12; --background-alt:#0d1320; --background-card:#11182a; --background-elevated:#131c2e;
        --border:#1f2a44; --border-light:#2a3a5f; --text-primary:#f3f6ff; --text-secondary:#d6def7; --text-light:#a8b4d9; --text-muted:#8a97bf;
        --accent-red:#1e40af; --accent-red-hover:#2563eb; --accent-red-bg:rgba(30,64,175,0.12);
        --accent-yellow:#fbbf24; --accent-red-rgb:30,64,175;
      }
      [data-theme='ml-native']{
        --background:#070a12;
        --background-alt:#0f1729;
        --background-card:#111827;
        --background-elevated:#1E293B;
        --surface-glass:rgba(15,23,42,0.6);
        --accent-red:#DA291C;
        --accent-red-text:#EF4444;
        --accent-red-hover:#F87171;
        --accent-red-bg:rgba(218,41,28,0.12);
        --accent-yellow:#FFD93D;
        --accent-red-rgb:218,41,28;
        --border:rgba(148,163,184,0.08);
        --border-light:rgba(148,163,184,0.12);
        --text-primary:#F1F5F9;
        --text-secondary:#CBD5E1;
        --text-light:#A8B8CB;
        --text-muted:#9BADC8;
        --primary:#F1F5F9;
        --terminal-green:#4ADE80;
        --font-mono:'JetBrains Mono','SF Mono',Monaco,monospace;
        --section-padding:clamp(5rem,10vh,8rem);
        --card-radius:16px;
        --card-radius-lg:20px;
      }
      [data-theme='ml-native'] .section{padding:var(--section-padding) 0}
      [data-theme='ml-native'] .section + .section{border-top:1px solid var(--border)}
    </style>
  </head>
  <body>
    <!-- Core Web Vitals Optimizer - High Priority -->
    <CoreWebVitalsOptimizer />
    
    <a class="skip-link" href="#main" tabindex="0">Skip to main content</a>
    <main id="main" role="main" aria-label="Main content">
      <slot />
    </main>
    
    <!-- Scroll Animations - Low Priority -->
    <ScrollAnimations 
      enableMagneticButtons={true}
      enableScrollProgress={true}
      enableParallax={false}
    />
    
    <!-- Accessibility Controller - Critical -->
    <script>
      // Initialize accessibility controller as soon as possible
      import('/src/utils/accessibility-controller.ts')
        .then(({ default: AccessibilityController }) => {
          window.accessibilityController = new AccessibilityController({
            enableHighContrast: true,
            enableFocusManagement: true,
            enableScreenReaderOptimizations: true,
            enableReducedMotion: true,
            enableKeyboardNavigation: true,
            announcePageChanges: true
          });
        })
        .catch(console.warn);
    </script>

    <!-- Performance Monitor - Development Only -->
    <script>
      if (import.meta.env.DEV) {
        // Dynamically import the performance dashboard in development
        import('/src/components/PerformanceDashboard.tsx')
          .then(({ PerformanceDashboard }) => {
            import('react').then((React) => {
              import('react-dom/client').then((ReactDOM) => {
                const container = document.createElement('div');
                container.id = 'performance-dashboard-root';
                document.body.appendChild(container);
                
                const root = ReactDOM.createRoot(container);
                root.render(React.createElement(PerformanceDashboard));
              });
            });
          })
          .catch(console.warn);
      }
    </script>

    <!-- Performance Monitor Component -->
    <PerformanceMonitor />
  </body>
</html>
<!-- Removed stray global style block below; theme overrides are now in <head> -->
<!--
<style is:global>
  :root {
    /* Brand palette tuned for AA contrast */
    --catalan-red: #DA291C;
    --catalan-yellow: #FFD93D;

    /* Base tokens */
    --primary: #F5F5F5;
    --secondary: #D4D4D4;
    --tertiary: #A3A3A3;
    --accent-red: #DC2626; /* primary red */
    --accent-red-hover: #EF4444;
    --accent-red-bg: rgba(220, 38, 38, 0.10);
    --accent-yellow: #FFD93D;
    --gradient-catalan: linear-gradient(135deg, var(--accent-red) 0%, var(--accent-yellow) 100%);

    /* Background surfaces */
    --background: #0A0A0A;
    --background-alt: #171717;
    --background-card: #1E1E1E;
    --background-elevated: #252525;
    /* RGB helpers */
    --background-rgb: 10, 10, 10;
    --accent-red-rgb: 220, 38, 38;

    /* Borders */
    --border: #333333; /* Dark borders */
    --border-light: #404040; /* Lighter borders */
    --border-red: rgba(218, 41, 28, 0.3); /* Red-tinted borders */
    
    /* Supporting colors for dark theme */
    --text-primary: #ffffff;
    --text-secondary: #e0e0e0;
    --text-light: #b0b0b0;
    --text-muted: #888888;
    
    /* Gradients */
    --gradient-red: linear-gradient(135deg, #DA291C 0%, #FF3D3D 100%);
    --gradient-dark: linear-gradient(135deg, #0a0a0a 0%, #1a1a1a 100%);
    
    /* Typography - Stylish Font Stack */
    --font-primary: 'Inter', -apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
    --font-display: 'Outfit', -apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
    --font-mono: 'SF Mono', Monaco, 'Cascadia Code', monospace;
    
    --font-weight-extralight: 200;
    --font-weight-light: 300;
    --font-weight-regular: 400;
    --font-weight-medium: 500;
    --font-weight-semibold: 600;
    --font-weight-bold: 700;
    --font-weight-black: 900;
    
    /* Spacing */
    --space-xs: 0.5rem;
    --space-sm: 1rem;
    --space-md: 2rem;
    --space-lg: 4rem;
    --space-xl: 8rem;
  }

  /* Navy Theme Prototype (scoped by data-theme on <html>) */
  [data-theme='navy'] {
    /* Swap accent system to deep navy blues while preserving contrast */
    --accent-red: #1e40af; /* blue-800 */
    --accent-red-hover: #2563eb; /* blue-600 */
    --accent-red-bg: rgba(30, 64, 175, 0.12);
    --accent-yellow: #60a5fa; /* lighten for dual-tone accents */
    --accent-red-rgb: 30, 64, 175;

    /* Optional: slightly cooler neutrals for surfaces */
    --background: #070a12;
    --background-alt: #0d1320;
    --background-card: #11182a;
    --background-elevated: #131c2e;
    --border: #1f2a44;
    --border-light: #2a3a5f;
    --text-primary: #f3f6ff;
    --text-secondary: #d6def7;
    --text-light: #a8b4d9;
    --text-muted: #8a97bf;
  }

  /* Navy + Gold (complementary accent) */
  [data-theme='navy-gold'] {
    /* Keep the navy surface & border system */
    --background: #070a12;
    --background-alt: #0d1320;
    --background-card: #11182a;
    --background-elevated: #131c2e;
    --border: #1f2a44;
    --border-light: #2a3a5f;
    --text-primary: #f3f6ff;
    --text-secondary: #d6def7;
    --text-light: #a8b4d9;
    --text-muted: #8a97bf;

    /* Dual-accent: navy primary, gold secondary */
    --accent-red: #1e40af;        /* navy */
    --accent-red-hover: #2563eb;  /* brighter blue hover */
    --accent-red-bg: rgba(30, 64, 175, 0.12);
    --accent-yellow: #fbbf24;     /* gold/amber 400 */
    --accent-red-rgb: 30, 64, 175;
  }

  /* Custom Scrollbar */
  ::-webkit-scrollbar {
    width: 8px;
  }

  ::-webkit-scrollbar-track {
    background: var(--background-alt);
  }

  ::-webkit-scrollbar-thumb {
    background: var(--border);
    border-radius: 4px;
  }

  ::-webkit-scrollbar-thumb:hover {
    background: var(--tertiary);
  }

  * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
  }

  html {
    scroll-behavior: smooth;
  }

  body {
    font-family: var(--font-primary);
    font-weight: var(--font-weight-regular); /* Default body text to regular */
    line-height: 1.7; /* Increased line height for readability */
    color: var(--primary);
    background-color: var(--background);
    font-size: 17px; /* Slightly larger base font size */
    letter-spacing: -0.01em;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }

  .skip-link {
    position: absolute;
    left: -999px;
    top: auto;
    width: 1px;
    height: 1px;
    overflow: hidden;
    z-index: 9999;
    background: var(--accent-red);
    color: var(--background);
    padding: 0.5rem 1rem;
    border-radius: 6px;
  }
  .skip-link:focus { left: 12px; top: 12px; width: auto; height: auto; }

  h1, h2, h3, h4, h5, h6 {
    font-family: var(--font-display);
    font-weight: 700;
    line-height: 1.15;
    margin-bottom: 1rem;
    letter-spacing: -0.01em;
    color: var(--primary);
  }

  h1 {
    font-size: clamp(2.5rem, 5vw, 4rem);
  }

  h2 {
    font-size: clamp(2rem, 4vw, 3rem);
  }

  h3 {
    font-size: clamp(1.5rem, 3vw, 2rem);
  }

  p {
    margin-bottom: 1.5rem; /* Increased paragraph spacing */
    line-height: 1.8; /* Increased line height for readability */
  }

  a {
    color: var(--primary);
    text-decoration: none;
    transition: all 0.2s ease-in-out; /* Smoother transitions */
    border-bottom: 1px solid transparent;
  }

  a:hover {
    color: var(--accent-red-hover); /* Enhanced hover color */
    border-color: var(--accent-red-hover); /* Stronger underline on hover */
    opacity: 1; /* Ensure full opacity */
    transform: translateY(-1px); /* Subtle lift effect */
  }

  .container {
    max-width: 1280px; /* Slightly wider container */
    margin: 0 auto;
    padding: 0 25px; /* Increased padding */
  }

  .section {
    padding: var(--space-xl) 0;
    position: relative; /* For potential background effects */
  }

  .accent-bar {
    width: 80px; /* Wider accent bar */
    height: 4px; /* Thicker accent bar */
    background: linear-gradient(90deg, var(--accent-red) 0%, var(--accent-yellow) 100%);
    margin: 1rem auto 2rem; /* Centered and more spacing */
    border-radius: 2px;
    opacity: 0.8;
  }

  @media (max-width: 768px) {
    .section {
      padding: var(--space-lg) 0;
    }
    .accent-bar {
      width: 60px;
      height: 3px;
      margin: 0.8rem auto 1.5rem;
    }
  }

  /* Dark Mode */
  @media (prefers-color-scheme: dark) {
    :root {
      --primary: #EAEAEA;
      --secondary: #BDBDBD;
      --tertiary: #8C8C8C;
      --background: #0A0A0A;
      --background-alt: #141414;
      --border: #2A2A2A;
      --accent-red: #F03A3A;
      --accent-yellow: #FFD93D;
      --background-rgb: 10, 10, 10;
      --accent-red-rgb: 240, 58, 58;
    }
    
    body {
      background: var(--background);
      color: var(--primary);
    }
    
    .navigation {
      background: rgba(10, 10, 10, 0.95); /* Match new dark background */
      box-shadow: 0 1px 0 rgba(255,255,255,.05);
    }
    
    .timeline-card, .publication-card, .research-card, .contact-card, .protein-viewer-container {
      background: var(--background-alt);
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.4); /* Stronger shadow for depth */
    }
    
    .footer {
      background: var(--background-alt);
      border-top-color: var(--border);
    }
    
    .social-links a {
      background: var(--background-alt);
      border-color: var(--border);
    }
    
    .social-links a:hover { background: rgba(var(--accent-red-rgb), 0.10); }
    
    a {
      color: var(--primary); /* Default link color */
    }
    
    a:hover {
      color: var(--accent-red); /* Accent color on hover */
    }
    
    .btn-primary {
      background: var(--accent-red);
      border-color: var(--accent-red);
      color: var(--background); /* Text color for primary button */
    }
    
    .btn-primary:hover { background: transparent; color: var(--accent-red); }

    /* Unified minimal hero accent: single top-right red glow with gentle drift */
    .hero-accent { position: absolute; inset: 0; z-index: -1; pointer-events: none; overflow: hidden; }
    .hero-accent::before {
      content: '';
      position: absolute;
      top: -12vh; right: -18vw;
      width: 64vw; height: 64vw;
      background:
        radial-gradient(40% 50% at 48% 52%, rgba(var(--accent-red-rgb), 0.28) 0%, rgba(var(--accent-red-rgb), 0.14) 40%, rgba(0,0,0,0) 75%),
        radial-gradient(12% 14% at 30% 70%, rgba(255,255,255,0.03) 0%, rgba(0,0,0,0) 100%);
      filter: blur(80px);
      transform: rotate(-6deg);
      animation: slow-drift 12s ease-in-out infinite;
    }
    /* Subtle dark secondary shape (Claude-inspired), minimal */
    .hero-accent::after {
      content: '';
      position: absolute;
      bottom: -16vh; left: -20vw;
      width: 52vw; height: 52vw;
      background:
        radial-gradient(40% 40% at 50% 50%, rgba(24,24,24, 0.75) 0%, rgba(0,0,0,0) 70%);
      filter: blur(55px);
      transform: rotate(1deg);
      animation: slow-drift-2 18s ease-in-out infinite;
    }
    @media (prefers-reduced-motion: reduce) { .hero-accent::before, .hero-accent::after { animation: none; } }
    @keyframes slow-drift {
      0%   { transform: translate3d(0, 0, 0) rotate(-6deg); }
      50%  { transform: translate3d(7px, -6px, 0) rotate(-4.8deg); }
      100% { transform: translate3d(0, 0, 0) rotate(-6deg); }
    }
    @keyframes slow-drift-2 {
      0%   { transform: translate3d(0, 0, 0) rotate(2deg); }
      50%  { transform: translate3d(-6px, 7px, 0) rotate(3.2deg); }
      100% { transform: translate3d(0, 0, 0) rotate(2deg); }
    }
    @media (max-width: 480px) {
      .hero-accent::before { width: 80vw; height: 80vw; right: -30vw; top: -18vh; filter: blur(60px); }
      .hero-accent::after { width: 60vw; height: 60vw; left: -30vw; bottom: -20vh; filter: blur(50px); }
    }
  }
</style>
-->
