---
import type { Lang } from '../../data/i18n';
import { translations } from '../../data/i18n';

export interface Props {
  lang: Lang;
}

const { lang } = Astro.props;
const t = translations[lang] || translations.en;

const sectionHeading: Record<Lang, string> = {
  en: 'Get in Touch',
  es: 'Contacto',
  ca: 'Contacte',
};

const whoamiOutput: Record<Lang, string> = {
  en: 'Ramon Roca Pinilla -- Biomedical Engineer & ML Enthusiast',
  es: 'Ramon Roca Pinilla -- Ingeniero Biomédico & Entusiasta ML',
  ca: 'Ramon Roca Pinilla -- Enginyer Biomedic & Entusiasta ML',
};

const linksLabel: Record<Lang, string> = {
  en: 'links.txt',
  es: 'enlaces.txt',
  ca: 'enllaços.txt',
};
---

<section id="contact" class="ml-contact section" aria-labelledby="contact-heading">
  <div class="container">
    <h2 id="contact-heading" class="ml-contact__heading">{sectionHeading[lang]}</h2>

    <div class="ml-terminal" role="region" aria-label="Contact information in terminal style">
      <!-- Terminal chrome — solid, no blur -->
      <div class="ml-terminal__chrome">
        <span class="ml-terminal__dot ml-terminal__dot--red" aria-hidden="true"></span>
        <span class="ml-terminal__dot ml-terminal__dot--yellow" aria-hidden="true"></span>
        <span class="ml-terminal__dot ml-terminal__dot--green" aria-hidden="true"></span>
        <span class="ml-terminal__chrome-title">contact@rrp ~ %</span>
      </div>

      <!-- Terminal body with CRT scanline overlay -->
      <div class="ml-terminal__body">
        <div class="ml-terminal__scanlines" aria-hidden="true"></div>

        <div class="ml-terminal__line">
          <span class="ml-terminal__prompt">$</span>
          <span class="ml-terminal__cmd">whoami</span>
        </div>
        <div class="ml-terminal__output">
          {whoamiOutput[lang]}
        </div>

        <div class="ml-terminal__line">
          <span class="ml-terminal__prompt">$</span>
          <span class="ml-terminal__cmd">echo $EMAIL</span>
        </div>
        <div class="ml-terminal__output">
          <a href="mailto:rroca@cmri.org.au" class="ml-terminal__link">rroca@cmri.org.au</a>
        </div>

        <div class="ml-terminal__line">
          <span class="ml-terminal__prompt">$</span>
          <span class="ml-terminal__cmd">cat {linksLabel[lang]}</span>
        </div>
        <div class="ml-terminal__output ml-terminal__output--links">
          <span class="ml-terminal__arrow" aria-hidden="true">&rarr;</span>
          <span class="ml-terminal__link-label">Google Scholar:</span>
          <a href="https://scholar.google.com/citations?user=jYIZGT0AAAAJ" target="_blank" rel="noopener noreferrer" class="ml-terminal__link">
            scholar.google.com/citations?user=jYIZGT0AAAAJ
          </a>
        </div>
        <div class="ml-terminal__output ml-terminal__output--links">
          <span class="ml-terminal__arrow" aria-hidden="true">&rarr;</span>
          <span class="ml-terminal__link-label">ORCID:</span>
          <a href="https://orcid.org/0000-0002-7393-6200" target="_blank" rel="noopener noreferrer" class="ml-terminal__link">
            orcid.org/0000-0002-7393-6200
          </a>
        </div>
        <div class="ml-terminal__output ml-terminal__output--links">
          <span class="ml-terminal__arrow" aria-hidden="true">&rarr;</span>
          <span class="ml-terminal__link-label">LinkedIn:</span>
          <a href="https://www.linkedin.com/in/ramon-roca-pinilla" target="_blank" rel="noopener noreferrer" class="ml-terminal__link">
            linkedin.com/in/ramon-roca-pinilla
          </a>
        </div>

        <div class="ml-terminal__line ml-terminal__line--cursor">
          <span class="ml-terminal__prompt">$</span>
          <span class="ml-terminal__cursor" aria-hidden="true">|</span>
        </div>
      </div>
    </div>
  </div>
</section>

<style>
  .ml-contact {
    background: var(--bg-base, #080B11);
    padding: var(--section-padding, 6rem) 0;
  }

  .ml-contact__heading {
    font-family: var(--font-display, 'Source Serif 4', serif);
    font-weight: 600;
    font-size: clamp(2rem, 4vw, 3rem);
    color: var(--text-primary, #EAEDF2);
    text-align: center;
    margin-bottom: 2.5rem;
    letter-spacing: -0.01em;
  }

  /* Wide terminal — solid surface, no glass */
  .ml-terminal {
    max-width: 720px;
    margin: 0 auto;
    border-radius: var(--card-radius, 8px);
    border: 1px solid var(--border-subtle);
    overflow: hidden;
    background: var(--bg-surface, #0E1219);
  }

  .ml-terminal__chrome {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.75rem 1rem;
    background: var(--bg-elevated, #141A24);
    border-bottom: 1px solid var(--border-subtle);
  }

  .ml-terminal__dot {
    width: 12px;
    height: 12px;
    border-radius: 50%;
  }

  .ml-terminal__dot--red { background: #DA291C; }
  .ml-terminal__dot--yellow { background: #D4A843; }
  .ml-terminal__dot--green { background: #4ADE80; }

  .ml-terminal__chrome-title {
    font-family: var(--font-mono, monospace);
    font-size: 0.75rem;
    color: var(--text-muted, #8B95A3);
    margin-left: 0.5rem;
  }

  .ml-terminal__body {
    padding: 1.75rem 2rem;
    font-family: var(--font-mono, monospace);
    font-size: 0.875rem;
    line-height: 1.7;
    position: relative;
  }

  /* Subtle CRT scanline overlay */
  .ml-terminal__scanlines {
    position: absolute;
    inset: 0;
    pointer-events: none;
    background: repeating-linear-gradient(
      to bottom,
      transparent 0px,
      transparent 2px,
      rgba(0,0,0,0.03) 2px,
      rgba(0,0,0,0.03) 4px
    );
    z-index: 1;
  }

  .ml-terminal__line {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    margin-top: 1rem;
    position: relative;
    z-index: 2;
  }

  .ml-terminal__line:first-of-type {
    margin-top: 0;
  }

  .ml-terminal__prompt {
    color: var(--accent-green, #4ADE80);
    font-weight: 700;
    user-select: none;
  }

  .ml-terminal__cmd {
    color: var(--text-primary, #EAEDF2);
    font-weight: 500;
  }

  .ml-terminal__output {
    color: var(--text-secondary, #B8BFC9);
    padding-left: 1.25rem;
    margin-top: 0.25rem;
    word-break: break-all;
    position: relative;
    z-index: 2;
  }

  .ml-terminal__output--links {
    display: flex;
    align-items: flex-start;
    gap: 0.375rem;
    flex-wrap: wrap;
    margin-top: 0.125rem;
  }

  .ml-terminal__arrow {
    color: var(--text-muted, #8B95A3);
    flex-shrink: 0;
  }

  .ml-terminal__link-label {
    color: var(--text-secondary, #B8BFC9);
    flex-shrink: 0;
    font-weight: 500;
  }

  .ml-terminal__link {
    color: var(--accent-warm, #C4956A);
    text-decoration: none;
    border-bottom: none;
    transition: all var(--transition-fast) var(--ease-default);
    word-break: break-all;
    padding: 0 3px;
    margin: 0 -3px;
    border-radius: 2px;
  }

  .ml-terminal__link:hover {
    background-color: var(--text-primary, #EAEDF2);
    color: var(--bg-base, #080B11);
    transform: none;
    border-bottom: none;
  }

  .ml-terminal__link:focus-visible {
    outline: 2px solid var(--accent-red, #DA291C);
    outline-offset: 2px;
    border-radius: 2px;
  }

  /* Blinking cursor */
  .ml-terminal__line--cursor {
    margin-top: 1.5rem;
  }

  .ml-terminal__cursor {
    color: var(--accent-green, #4ADE80);
    font-weight: 700;
    animation: blink-cursor 1s step-end infinite;
  }

  @keyframes blink-cursor {
    0%, 100% { opacity: 1; }
    50% { opacity: 0; }
  }

  @media (max-width: 768px) {
    .ml-contact {
      padding: 4rem 0;
    }

    .ml-terminal__body {
      padding: 1.25rem;
      font-size: 0.8125rem;
    }

    .ml-terminal__output--links {
      flex-direction: column;
      gap: 0;
    }
  }

  @media (prefers-reduced-motion: reduce) {
    .ml-terminal__cursor {
      animation: none;
      opacity: 1;
    }
  }
</style>
