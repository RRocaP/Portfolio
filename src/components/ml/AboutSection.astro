---
import type { Lang } from '../../data/i18n';
import { aboutData } from '../../data/i18n';
import { scholarMetrics } from '../../data/metrics';

export interface Props {
  lang: Lang;
}

const { lang } = Astro.props;
const about = aboutData[lang] || aboutData.en;

const sectionHeading: Record<Lang, string> = {
  en: 'About',
  es: 'Sobre mi',
  ca: 'Sobre mi',
};
---

<section id="about" class="ml-about section" aria-labelledby="about-heading">
  <div class="container">
    <div class="ml-about__layout">
      <div class="ml-about__text">
        <h2 id="about-heading" class="ml-about__heading">{sectionHeading[lang]}</h2>
        <p class="ml-about__bio">{about.bio}</p>
        <p class="ml-about__focus-intro">{about.focusIntro}</p>
        <p class="ml-about__patent">
          With {scholarMetrics.publications} {about.patent}
        </p>
      </div>

      <div class="ml-about__cards">
        {about.areas.map((area, i) => (
          <article class={`ml-about__card ml-about__card--${i + 1}`}>
            <h3 class="ml-about__card-title">{area.title}</h3>
            <p class="ml-about__card-desc">{area.description}</p>
          </article>
        ))}
      </div>
    </div>
  </div>
</section>

<style>
  .ml-about {
    background: var(--bg-surface, #0E1219);
    padding: var(--section-padding, 6rem) 0;
  }

  .ml-about__layout {
    display: grid;
    grid-template-columns: 1.1fr 0.9fr;
    gap: 4rem;
    align-items: start;
  }

  .ml-about__heading {
    font-family: var(--font-display, 'Source Serif 4', serif);
    font-weight: 600;
    font-size: clamp(2rem, 4vw, 3rem);
    color: var(--text-primary, #EAEDF2);
    margin-bottom: 1.5rem;
    letter-spacing: -0.01em;
  }

  .ml-about__bio {
    font-family: var(--font-body, 'DM Sans', sans-serif);
    font-size: 1.125rem;
    color: var(--text-secondary, #B8BFC9);
    line-height: 1.7;
    margin-bottom: 1.25rem;
  }

  .ml-about__focus-intro {
    font-family: var(--font-body, 'DM Sans', sans-serif);
    font-size: 1rem;
    color: var(--text-secondary, #B8BFC9);
    line-height: 1.7;
    margin-bottom: 1.5rem;
  }

  .ml-about__patent {
    font-family: var(--font-body, 'DM Sans', sans-serif);
    font-size: 1rem; /* WCAG fix: was 0.9375rem (15px), now 16px for body copy readability */
    color: var(--text-secondary, #B8BFC9); /* WCAG fix: was text-muted, bumped for body copy contrast */
    line-height: 1.65;
  }

  /* Cards â€” solid surface, no glass morphism */
  .ml-about__cards {
    display: flex;
    flex-direction: column;
    gap: 1rem;
  }

  .ml-about__card {
    background: var(--bg-elevated, #141A24);
    border: 1px solid var(--border-subtle);
    border-radius: var(--card-radius, 8px);
    padding: 1.5rem 1.75rem;
    transition: all var(--transition-moderate) var(--ease-out-expo);
    border-left: 3px solid transparent;
  }

  .ml-about__card--1 { border-left-color: #DA291C; }
  .ml-about__card--2 { border-left-color: #C4956A; }
  .ml-about__card--3 { border-left-color: #9BA5B3; }

  .ml-about__card:hover {
    border-color: var(--border-emphasis);
    box-shadow: 0 12px 24px rgba(0,0,0,0.5);
    border-left-width: 4px;
    transform: translateY(-4px);
  }

  .ml-about__card--1:hover { border-left-color: #DA291C; }
  .ml-about__card--2:hover { border-left-color: #C4956A; }
  .ml-about__card--3:hover { border-left-color: #9BA5B3; }

  .ml-about__card-title {
    font-family: var(--font-display, 'Source Serif 4', serif);
    font-weight: 600;
    font-size: 1.0625rem;
    color: var(--text-primary, #EAEDF2);
    margin-bottom: 0.375rem;
    line-height: 1.3;
  }

  .ml-about__card-desc {
    font-family: var(--font-body, 'DM Sans', sans-serif);
    font-size: 0.9375rem;
    color: var(--text-secondary, #B8BFC9); /* WCAG fix: was text-muted, card desc is content text */
    line-height: 1.6;
    margin-bottom: 0;
  }

  @media (max-width: 768px) {
    .ml-about {
      padding: 4rem 0;
    }

    .ml-about__layout {
      grid-template-columns: 1fr;
      gap: 2.5rem;
    }
  }
</style>
