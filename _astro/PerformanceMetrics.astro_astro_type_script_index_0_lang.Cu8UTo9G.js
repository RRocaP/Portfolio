var e=Object.defineProperty,t=(t,i,r)=>((t,i,r)=>i in t?e(t,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[i]=r)(t,"symbol"!=typeof i?i+"":i,r);const i=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&e.target.classList.add("animated")})});document.querySelectorAll(".metric-card").forEach(e=>{i.observe(e)});class r{constructor(e){t(this,"metrics",[]),t(this,"budget"),t(this,"observers",new Map),t(this,"isInitialized",!1),this.budget={lcp:2500,fid:100,cls:.1,fcp:1800,ttfb:800,transferSize:1048576,resourceCount:50,...e}}init(){this.isInitialized||"undefined"==typeof window||(this.isInitialized=!0,this.setupWebVitalsTracking(),this.setupNavigationTracking(),this.setupResourceTracking(),this.setupCustomMetrics(),this.scheduleReporting())}setupWebVitalsTracking(){const e=window["web-vitals"];if(e){const{onLCP:t,onFID:i,onCLS:r,onFCP:n,onTTFB:s}=e;t(e=>this.recordMetric("lcp",e.value)),i(e=>this.recordMetric("fid",e.value)),r(e=>this.recordMetric("cls",e.value)),n(e=>this.recordMetric("fcp",e.value)),s(e=>this.recordMetric("ttfb",e.value))}}setupNavigationTracking(){window.addEventListener("load",()=>{requestIdleCallback(()=>{const e=performance.getEntriesByType("navigation")[0];e&&(this.recordMetric("domContentLoaded",e.domContentLoadedEventEnd),this.recordMetric("loadComplete",e.loadEventEnd),this.recordMetric("transferSize",e.transferSize))})})}setupResourceTracking(){if("PerformanceObserver"in window){const e=new PerformanceObserver(e=>{const t=e.getEntries();this.recordMetric("resourceCount",t.length)});e.observe({entryTypes:["resource"]}),this.observers.set("resource",e)}}setupCustomMetrics(){if(window.addEventListener("load",()=>{let e=0;if("PerformanceObserver"in window){const i=new PerformanceObserver(t=>{const i=t.getEntries();i.length>0&&(e=i[i.length-1].startTime+i[i.length-1].duration)});try{i.observe({entryTypes:["longtask"]}),this.observers.set("longtask",i)}catch(t){}}setTimeout(()=>{const t=Math.max(e+5e3,performance.now());this.recordMetric("timeToInteractive",t)},1e4)}),"PerformanceObserver"in window)try{const e=new PerformanceObserver(e=>{const t=e.getEntries();for(const i of t)"first-paint"===i.name&&this.recordMetric("firstPaint",i.startTime)});e.observe({entryTypes:["paint"]}),this.observers.set("paint",e)}catch(e){}}recordMetric(e,t){this.getCurrentMetric()[e]=t,this.checkBudgetCompliance(e,t)}getCurrentMetric(){return(0===this.metrics.length||this.isMetricComplete(this.metrics[this.metrics.length-1]))&&this.metrics.push(this.createBaseMetric()),this.metrics[this.metrics.length-1]}createBaseMetric(){const e=navigator.connection;return{timestamp:Date.now(),url:window.location.href,userAgent:navigator.userAgent,viewport:{width:window.innerWidth,height:window.innerHeight},connection:e?{effectiveType:e.effectiveType,downlink:e.downlink}:void 0}}isMetricComplete(e){return!!(e.lcp&&e.fcp&&e.ttfb)}checkBudgetCompliance(e,t){const i=this.budget[e];i&&t>i&&window.dispatchEvent(new CustomEvent("performance-budget-exceeded",{detail:{metric:e,value:t,budget:i}}))}scheduleReporting(){setInterval(()=>{this.reportMetrics()},3e4),window.addEventListener("beforeunload",()=>{this.reportMetrics(!0)}),document.addEventListener("visibilitychange",()=>{"hidden"===document.visibilityState&&this.reportMetrics(!0)})}reportMetrics(e=!1){const t=this.metrics.filter(e=>this.isMetricComplete(e));if(0!==t.length||e){if(window.gtag&&t.forEach(e=>{window.gtag("event","performance_metrics",{custom_map:{dimension1:e.lcp,dimension2:e.fid,dimension3:e.cls,dimension4:e.fcp,dimension5:e.ttfb}})}),"undefined"!=typeof localStorage){const e=[...JSON.parse(localStorage.getItem("performanceMetrics")||"[]"),...t].slice(-50);localStorage.setItem("performanceMetrics",JSON.stringify(e))}this.sendToReportingEndpoint(t),this.metrics=this.metrics.filter(e=>!this.isMetricComplete(e))}}sendToReportingEndpoint(e){const t=window.PERFORMANCE_REPORTING_URL;t&&0!==e.length&&("sendBeacon"in navigator?navigator.sendBeacon(t,JSON.stringify(e)):fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e),keepalive:!0}).catch(()=>{}))}getMetrics(){return[...this.metrics]}getBudgetStatus(){const e=this.getCurrentMetric(),t={};for(const[i,r]of Object.entries(this.budget)){const n=e[i];t[i]={current:n,budget:r,passed:!n||n<=r}}return t}destroy(){this.observers.forEach(e=>e.disconnect()),this.observers.clear(),this.isInitialized=!1}}let n=null;function s(e){return n||(n=new r(e),n.init()),n}if("undefined"!=typeof window&&document.addEventListener("DOMContentLoaded",()=>{s()}),s({lcp:2500,fid:100,cls:.1,fcp:1800,ttfb:800,transferSize:1048576,resourceCount:50}),(async()=>{try{const e=window["web-vitals"];if(!e)return;const{onCLS:t,onFID:i,onFCP:r,onLCP:n,onTTFB:s}=e,o=e=>{window.gtag&&window.gtag("event",e.name,{value:Math.round(e.value),metric_id:e.id,metric_value:e.value,metric_delta:e.delta})};t(o),i(o),r(o),n(o),s(o)}catch(e){}})(),"IntersectionObserver"in window){const e=new IntersectionObserver(t=>{for(const i of t)if(i.isIntersecting){const t=i.target,r=t.dataset.src;if(r){performance.now();t.onload=()=>{performance.now()},t.src=r,t.removeAttribute("data-src")}e.unobserve(t)}},{rootMargin:"200px 0px"});document.querySelectorAll("img[data-src]").forEach(t=>e.observe(t))}window.addEventListener("performance-budget-exceeded",e=>{const{metric:t,value:i,budget:r}=e.detail;window.MONITORING_ENDPOINT&&fetch(window.MONITORING_ENDPOINT,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:"budget_violation",metric:t,value:i,budget:r,timestamp:Date.now(),url:window.location.href}),keepalive:!0}).catch(()=>{})});
